<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./css/index.min.css">
    <link rel="stylesheet" href="./swiper/swiper-4.1.6.min.css">
    <link rel="stylesheet" href="./iconfont/iconfont.css">
    <script src="./js/common/flexible.js"></script>
</head>

<body>
    <div class="wrapper">
        <footer class="footer" id="footer">
            <dl>
                <dd class="icon-iconhuidaoshouye iconfont"></dd>
                <dt>首页</dt>
            </dl>
            <dl class="active">
                <dd class="icon-wodedingdan iconfont"></dd>
                <dt>分类</dt>
            </dl>
            <dl>
                <dd class="icon-daishouhuo-01 iconfont"></dd>
                <dt>购物车</dt>
            </dl>
            <dl>
                <dd class="icon-gerenxinxi iconfont"></dd>
                <dt>我的</dt>
            </dl>
        </footer>
    </div>
</body>

<script src="./js/common/zepto.js"></script>
<script src="./js/common/better-scroll.js"></script>

<script src="./swiper/swiper-4.1.6.min.js"></script>
<script src="./js/index.js"></script>

<script>
    var Bscoll = new BScroll('.leftslide', {
        click: true,
        probeType: 2,
        scrollBar: true
    })
    var Bscolld = new BScroll('.rightslide', {
        click: true,
        probeType: 2,
        scrollBar: true
    });
    var Myswiperd = new Swiper('.swiper-container', {
        initialSlide: 1,
    })
    var Myswiper = new Swiper('.sectionCenter', {
        on: {
            slideChange: function() {
                // var io = Myswiper.activeIndex;
                // $('#footer').find('dl').eq(io).addClass('active').siblings().removeClass('active')
            }
        },
    });
    //侧边栏点击高亮
    $('.list').on('click', 'li', function() {
        $(this).addClass('fontd').siblings().removeClass('fontd');
        var ht = $(this).html();
        $('.righth1').html(ht);
    });
    //脚部点击切换颜色和section
    $('#footer').on('click', 'dl', function() {
        $(this).addClass('active').siblings().removeClass('active');
        var ind = $(this).index();
        Myswiper.slideTo(ind, 200)

    });
    //ajax请求
    $.ajax({
        url: "./data/data.json",
        data: {
            name: '1026',
            pic: "100"
        },
        success: function(data) {
            if (data.code === 0) {
                init(data)
            } else {
                console.log('失败')
            }
        }
    });
    //初始化函数
    function init(data) {
        leftData(data.left)
        rightData(data.init)
        clickd(data.right)
    }
    //侧边栏渲染
    function leftData(data) {
        html = '';
        $.each(data, function(i, v) {
            html += `<li data-id='${v.id}'>${v.text}</li>`
        })
        $('#list').append(html);
        $('#list').find('li').eq(0).addClass('fontd')
    }
    //右侧商品默认页面
    function rightData(data) {
        add = '';
        $.each(data, function(i, v) {
            add += `
                     <dl>
                        <dd><img src="${v.img}" alt=""></dd>
                     <dt>${v.txt}</dt>
                </dl>
                `;
        })

        $('#rightslide_next').html(add)
    }
    //点击左侧渲染右侧商品
    function clickd(data) {
        $('#list').on('click', 'li', function() {
            var indexleft = $(this).index();
            console.log(indexleft)
            if (indexleft > 10) {
                var indexleft = (indexleft % 10) - 1;
            }
            var Datad = filt(data, "id", indexleft)
            rightData(Datad)
        })
    }
    //筛选数据函数
    function filt(data, key, val) {
        return data.filter(function(item) {
            return item[key] === val;
        })
    }
</script>

</html>